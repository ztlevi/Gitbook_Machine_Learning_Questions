
<!DOCTYPE HTML>
<html lang>
    <head>
        <meta charset="UTF-8">
        <meta content="text/html; charset=utf-8" http-equiv="Content-Type">
        <title>DBSCAN &#xB7; GitBook</title>
        <meta http-equiv="X-UA-Compatible" content="IE=edge">
        <meta name="description" content>
        <meta name="generator" content="GitBook 3.2.3">
        
        
        
    
    <link rel="stylesheet" href="../gitbook/style.css">

    
            
                
                <link rel="stylesheet" href="../gitbook/gitbook-plugin-katex/katex.min.css">
                
            
                
                <link rel="stylesheet" href="../gitbook/gitbook-plugin-custom-js-css/9eb07385451571ed1c43d6bfc772c8d5-docsearch.css">
                
            
                
                <link rel="stylesheet" href="../gitbook/gitbook-plugin-docsearch/doc-search.css">
                
            
                
                <link rel="stylesheet" href="../gitbook/gitbook-plugin-intopic-toc/style.css">
                
            
                
                <link rel="stylesheet" href="../gitbook/gitbook-plugin-highlight/website.css">
                
            
                
                <link rel="stylesheet" href="../gitbook/gitbook-plugin-fontsettings/website.css">
                
            
        

    

    
        
    
        
    
        
    
        
    
        
    
        
    

        
    
    
    <meta name="HandheldFriendly" content="true">
    <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black">
    <link rel="apple-touch-icon-precomposed" sizes="152x152" href="../gitbook/images/apple-touch-icon-precomposed-152.png">
    <link rel="shortcut icon" href="../gitbook/images/favicon.ico" type="image/x-icon">

    
    <link rel="next" href="autoencoder_anomaly.html">
    
    
    <link rel="prev" href="./">
    

    </head>
    <body>
        
<div class="book">
    <div class="book-summary"><div id="book-search-input">
    <input type="text" id="book-doc-search-input" placeholder="Type to search">
</div>
        
            
            
                <nav role="navigation">
                


<ul class="summary">
    
    

    

    
        
        
    
        <li class="chapter " data-level="1.1" data-path="../">
            
                <a href="../">
            
                    
                    Introduction
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2" data-path="../basics/">
            
                <a href="../basics/">
            
                    
                    Basics
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.2.1" data-path="../basics/optimization.html">
            
                <a href="../basics/optimization.html">
            
                    
                    Optimization
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2.2" data-path="../basics/how_to_prevent_overfitting.html">
            
                <a href="../basics/how_to_prevent_overfitting.html">
            
                    
                    How to prevent overfitting
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2.3" data-path="../basics/linear_algebra.html">
            
                <a href="../basics/linear_algebra.html">
            
                    
                    Linear Algebra
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2.4" data-path="../basics/clustering.html">
            
                <a href="../basics/clustering.html">
            
                    
                    Clustering
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2.5" data-path="../basics/calculate_parameters_in_cnn.html">
            
                <a href="../basics/calculate_parameters_in_cnn.html">
            
                    
                    Calculate Parameters in CNN
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2.6" data-path="../basics/weight_norm_and_layer_norm.html">
            
                <a href="../basics/weight_norm_and_layer_norm.html">
            
                    
                    Weight norm and layer norm
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2.7" data-path="../basics/Confidence_Interval.html">
            
                <a href="../basics/Confidence_Interval.html">
            
                    
                    Confidence Interval
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2.8" data-path="../basics/Quantization.html">
            
                <a href="../basics/Quantization.html">
            
                    
                    Quantization
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.3" data-path="../classical_ml/">
            
                <a href="../classical_ml/">
            
                    
                    Classical Machine Learning
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.4" data-path="../neural_networks/">
            
                <a href="../neural_networks/">
            
                    
                    Neural Networks
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.4.1" data-path="../neural_networks/different_types_of_convolution.html">
            
                <a href="../neural_networks/different_types_of_convolution.html">
            
                    
                    Different Types of Convolution
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.4.2" data-path="../neural_networks/loss/">
            
                <a href="../neural_networks/loss/">
            
                    
                    Loss
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.4.2.1" data-path="../neural_networks/loss/Hinge_Loss.html">
            
                <a href="../neural_networks/loss/Hinge_Loss.html">
            
                    
                    Hinge Loss
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.4.2.2" data-path="../neural_networks/loss/cross_entropy_loss.html">
            
                <a href="../neural_networks/loss/cross_entropy_loss.html">
            
                    
                    Cross-Entropy Loss
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.4.2.3" data-path="../neural_networks/loss/binary_cross_entropy_loss.html">
            
                <a href="../neural_networks/loss/binary_cross_entropy_loss.html">
            
                    
                    Binary Cross-Entropy Loss
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.4.2.4" data-path="../neural_networks/loss/categorical_cross_entropy_loss.html">
            
                <a href="../neural_networks/loss/categorical_cross_entropy_loss.html">
            
                    
                    Categorical Cross-Entropy Loss
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.4.2.5" data-path="../neural_networks/loss/focal_loss.html">
            
                <a href="../neural_networks/loss/focal_loss.html">
            
                    
                    Optional: Focal Loss
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.4.2.6" data-path="../neural_networks/loss/coral_loss.html">
            
                <a href="../neural_networks/loss/coral_loss.html">
            
                    
                    Optional: CORAL Loss
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.4.3" data-path="../neural_networks/resnet.html">
            
                <a href="../neural_networks/resnet.html">
            
                    
                    Resnet
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.4.4" data-path="../neural_networks/mobilenet.html">
            
                <a href="../neural_networks/mobilenet.html">
            
                    
                    Mobilenet
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.5" data-path="../cv/">
            
                <a href="../cv/">
            
                    
                    Computer Vision
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.5.1" data-path="../cv/two-stage-detector/">
            
                <a href="../cv/two-stage-detector/">
            
                    
                    Two Stage Object Detection
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.5.1.1" data-path="../cv/two-stage-detector/metrics.html">
            
                <a href="../cv/two-stage-detector/metrics.html">
            
                    
                    Metrics
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.5.1.2" data-path="../cv/two-stage-detector/roi.html">
            
                <a href="../cv/two-stage-detector/roi.html">
            
                    
                    ROI
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.5.1.3" data-path="../cv/two-stage-detector/r-cnn.html">
            
                <a href="../cv/two-stage-detector/r-cnn.html">
            
                    
                    R-CNN
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.5.1.4" data-path="../cv/two-stage-detector/fast-rcnn.html">
            
                <a href="../cv/two-stage-detector/fast-rcnn.html">
            
                    
                    Fast RCNN
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.5.1.5" data-path="../cv/two-stage-detector/faster-rcnn.html">
            
                <a href="../cv/two-stage-detector/faster-rcnn.html">
            
                    
                    Faster RCNN
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.5.1.6" data-path="../cv/two-stage-detector/mask-rcnn.html">
            
                <a href="../cv/two-stage-detector/mask-rcnn.html">
            
                    
                    Mask RCNN
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.5.2" data-path="../cv/one-stage-detector/">
            
                <a href="../cv/one-stage-detector/">
            
                    
                    One Stage Object Detection
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.5.2.1" data-path="../cv/one-stage-detector/yolo.html">
            
                <a href="../cv/one-stage-detector/yolo.html">
            
                    
                    YOLO
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.5.2.2" data-path="../cv/one-stage-detector/ssd.html">
            
                <a href="../cv/one-stage-detector/ssd.html">
            
                    
                    Single Shot MultiBox Detector(SSD)
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.5.2.3" data-path="../cv/one-stage-detector/fpn.html">
            
                <a href="../cv/one-stage-detector/fpn.html">
            
                    
                    FPN
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.5.3" data-path="../cv/segmentation/">
            
                <a href="../cv/segmentation/">
            
                    
                    Segmentation
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.5.3.1" data-path="../cv/segmentation/panoptic.html">
            
                <a href="../cv/segmentation/panoptic.html">
            
                    
                    Panoptic Segmentation
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.5.3.2" data-path="../cv/segmentation/PSPNet.html">
            
                <a href="../cv/segmentation/PSPNet.html">
            
                    
                    PSPNet
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.5.4" data-path="../cv/facenet.html">
            
                <a href="../cv/facenet.html">
            
                    
                    FaceNet
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.5.5" data-path="../cv/gan.html">
            
                <a href="../cv/gan.html">
            
                    
                    GAN
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.5.6" data-path="../cv/Object_detection_imbalance.html">
            
                <a href="../cv/Object_detection_imbalance.html">
            
                    
                    Imbalance problem in object detection
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.6" data-path="../nlp/">
            
                <a href="../nlp/">
            
                    
                    NLP
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.6.1" data-path="../nlp/embedding.html">
            
                <a href="../nlp/embedding.html">
            
                    
                    Embedding
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.6.2" data-path="../nlp/rnn.html">
            
                <a href="../nlp/rnn.html">
            
                    
                    RNN
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.6.3" data-path="../nlp/lstm.html">
            
                <a href="../nlp/lstm.html">
            
                    
                    LSTM
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.7" data-path="../parallel-computeing/">
            
                <a href="../parallel-computeing/">
            
                    
                    Parallel Computeing
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.7.1" data-path="../parallel-computeing/communication.html">
            
                <a href="../parallel-computeing/communication.html">
            
                    
                    Communication
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.7.2" data-path="../parallel-computeing/sync_mapreduce.html">
            
                <a href="../parallel-computeing/sync_mapreduce.html">
            
                    
                    MapReduce
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.7.3" data-path="../parallel-computeing/parameter_server.html">
            
                <a href="../parallel-computeing/parameter_server.html">
            
                    
                    Parameter Server
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.7.4" data-path="../parallel-computeing/decentralized_and_ring_allreduce.html">
            
                <a href="../parallel-computeing/decentralized_and_ring_allreduce.html">
            
                    
                    Decentralized And Ring All Reduce
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.7.5" data-path="../parallel-computeing/federated_learning.html">
            
                <a href="../parallel-computeing/federated_learning.html">
            
                    
                    Federated Learning
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.8" data-path="./">
            
                <a href="./">
            
                    
                    Anomaly Detection
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter active" data-level="1.8.1" data-path="dbscan.html">
            
                <a href="dbscan.html">
            
                    
                    DBSCAN
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.8.2" data-path="autoencoder_anomaly.html">
            
                <a href="autoencoder_anomaly.html">
            
                    
                    Autoencoder
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.9" data-path="../visualization/">
            
                <a href="../visualization/">
            
                    
                    Visualization
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.9.1" data-path="../visualization/saliency_maps.html">
            
                <a href="../visualization/saliency_maps.html">
            
                    
                    Saliency Maps
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.9.2" data-path="../visualization/fooling_images.html">
            
                <a href="../visualization/fooling_images.html">
            
                    
                    Fooling images
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.9.3" data-path="../visualization/class_visualization.html">
            
                <a href="../visualization/class_visualization.html">
            
                    
                    Class Visualization
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    

    

    <li class="divider"></li>

    <li>
        <a href="https://www.gitbook.com" target="blank" class="gitbook-link">
            Published with GitBook
        </a>
    </li>
</ul>


                </nav>
            
        
    </div>

    <div class="book-body">
        
            <div class="body-inner">
                
                    

<div class="book-header" role="navigation">
    

    <!-- Title -->
    <h1>
        <i class="fa fa-circle-o-notch fa-spin"></i>
        <a href="..">DBSCAN</a>
    </h1>
</div>




                    <div class="page-wrapper" tabindex="-1" role="main">
                        <div class="page-inner">
                            
                                <section class="normal markdown-section">
                                
                                <h2 id="outlier-detection-for-a-2d-feature-space-in-python-dbscan">Outlier Detection for a 2D Feature Space in Python (DBSCAN)</h2>
<h3 id="how-to-detect-outliers-using-plotting-and-clustering-techniques-to-analyze-the-dependency-of-two-features">How to detect outliers using plotting and clustering techniques to analyze the dependency of two features</h3>
<p>After collecting all your courage to start a machine learning project, you firstly have to think about <strong>how</strong> and <strong>where</strong> <strong>to</strong> actually <strong>start</strong>. Following picture shows a typical <a href="https://cloud.google.com/ml-engine/docs/ml-solutions-overview" target="_blank">machine learning workflow</a>. The very beginning of every machine learning project is to collect and prepare essential data to be able to be processed by those fancy algorithms, such as <a href="https://github.com/ztlevi/Machine_Learning_Questions/tree/26cb30cb7a3ec95f737534585c8ae80567d03d7b/how-to-build-your-own-neural-network-from-scratch-in-python-68998a08e4f6/README.md" target="_blank">neural networks</a> or <a href="https://github.com/ztlevi/Machine_Learning_Questions/tree/26cb30cb7a3ec95f737534585c8ae80567d03d7b/support-vector-machine-introduction-to-machine-learning-algorithms-934a444fca47/README.md" target="_blank">support vector machines</a>.</p>
<p><img src="../.gitbook/assets/dbscan_1.png" alt></p>
<p>Besides creating some funky first visualizations of your sourced dataset or engineering used features, you also want to detect if you have any sneaky outliers in your dataset.</p>
<p>This article provides a <strong>step-by-step guide</strong> <strong>on how to detect outliers</strong> in the dependency between two features (aka attributes or variables), also called a <strong>two-dimensional feature space.</strong></p>
<h2 id="outlier-detection-&#x2014;-lets-get-started">OUTLIER DETECTION &#x2014; LET&#x2019;S GET STARTED!</h2>
<p>This project was was developed in the IDE PyCharm with the Project Interpreter <strong>Python 3.7</strong>. However, you are free to apply the code in any other environment or notebook! The full project can be found <a href="https://github.com/JOPloume/outlier-detection-2D-feature-space" target="_blank">here</a>.</p>
<h2 id="1-&#x2014;-visualizing-the-feature-space">#1 &#x2014; Visualizing the feature space.</h2>
<p>First step is bringing in some visuals of the feature space we are dealing with. This project makes use of the <em>wine dataset</em> that comes together with the framework <a href="https://scikit-learn.org/stable/index.html" target="_blank">scikit learn</a>.</p>
<p>We might not be enjoying wine as much as Amy Schumer does, but we still think wine is an amazingly tasty research object to investigate. The 2D feature space we will be examining is the dependency between the <strong>concentration of flavanoids</strong> (a class of metabolites) and the <strong>color intensity</strong> of wine.</p>
<p><strong>Following code provides an initial visualization of the 2D feature space.</strong></p>
<pre><code class="lang-python"><span class="hljs-keyword">import</span> pandas <span class="hljs-keyword">as</span> pd
<span class="hljs-keyword">import</span> sys
<span class="hljs-keyword">from</span> sklearn.cluster <span class="hljs-keyword">import</span> DBSCAN
<span class="hljs-keyword">from</span> collections <span class="hljs-keyword">import</span> Counter

<span class="hljs-comment"># Reading in 2D Feature Space</span>
feature_space = pd.read_csv(<span class="hljs-string">&quot;../datasets/wine-data.csv&quot;</span>, header=<span class="hljs-keyword">None</span>, sep=<span class="hljs-string">&quot;,&quot;</span>)
data = feature_space.iloc[:, <span class="hljs-number">0</span>:<span class="hljs-number">2</span>].values

<span class="hljs-comment"># DBSCAN model with parameters</span>
model = DBSCAN(eps=<span class="hljs-number">0.8</span>, min_samples=<span class="hljs-number">10</span>).fit(data)

<span class="hljs-comment"># Creating Panda DataFrame with Labels for Outlier Detection</span>
outlier_df = pd.DataFrame(data)

<span class="hljs-comment"># Printing total number of values for each label</span>
print(Counter(model.labels_))

<span class="hljs-comment"># Printing DataFrame being considered as Outliers -1</span>
print(outlier_df[model.labels_ == <span class="hljs-number">-1</span>])

<span class="hljs-comment"># Printing and Indicating which type of object outlier_df is</span>
print(type(outlier_df))

<span class="hljs-comment"># Exporting this DataFrame to CSV</span>
outlier_df[model.labels_ == <span class="hljs-number">-1</span>].to_csv(<span class="hljs-string">&quot;../datasets/dbscan-outliers.csv&quot;</span>)

sys.exit()
</code></pre>
<pre><code class="lang-python"><span class="hljs-keyword">import</span> matplotlib.pyplot <span class="hljs-keyword">as</span> plt
<span class="hljs-keyword">import</span> sys
<span class="hljs-keyword">from</span> numpy <span class="hljs-keyword">import</span> genfromtxt

<span class="hljs-comment"># NumPy function to create array from tabular dataset</span>
my_csv = genfromtxt(<span class="hljs-string">&apos;../datasets/wine-data.csv&apos;</span>, delimiter=<span class="hljs-string">&apos;,&apos;</span>)

<span class="hljs-comment"># Slicing array</span>
array_flavanoids = my_csv[:, <span class="hljs-number">0</span>]

<span class="hljs-comment"># Slicing array</span>
array_colorintensity = my_csv[:, <span class="hljs-number">1</span>]

<span class="hljs-comment"># Scatter plot function</span>
plt.scatter(array_flavanoids, array_colorintensity, c=<span class="hljs-string">&apos;b&apos;</span>, marker=<span class="hljs-string">&apos;o&apos;</span>)
plt.xlabel(<span class="hljs-string">&apos;Concentration of flavanoids&apos;</span>, fontsize=<span class="hljs-number">16</span>)
plt.ylabel(<span class="hljs-string">&apos;Color intensity&apos;</span>, fontsize=<span class="hljs-number">16</span>)
plt.title(<span class="hljs-string">&apos;Concentration of flavanoids vs Color intensity&apos;</span>, fontsize=<span class="hljs-number">20</span>)
plt.show()

sys.exit()
</code></pre>
<p><img src="../.gitbook/assets/dbscan_2.png" alt></p>
<p>Awesome! Now we have a first &#x201C;feel&#x201D; of the dependency we are dealing with.</p>
<h2 id="2-&#x2014;-clustering-data-points">#2 &#x2014; Clustering data points.</h2>
<p>We might already see some clusters and outliers in our first visualization, but to give our intuition a bit more statistical grounding, we take help of a clustering algorithm. <strong>DBSCAN</strong> <em>(Density-Based Spatial Clustering of Applications with Noise)</em> is a clustering algorithm commonly used for outlier detection. Here, a data instance is considered as outlier, if it does not belong to any cluster.</p>
<blockquote>
<p>&#x201C;DBSCAN algorithm requires 2 parameters &#x2014; epsilon, which specifies how close points should be to each other to be considered a part of a cluster; and minPts, which specifies how many neighbors a point should have to be included into a cluster.&#x201D; &#x2014; alitouka</p>
</blockquote>
<p>&#x201C;DBSCAN algorithm requires 2 parameters &#x2014; <strong>epsilon</strong>, which specifies how close points should be to each other to be considered a part of a cluster; and <strong>minPts</strong>, which specifies how many neighbors a point should have to be included into a cluster.&#x201D; &#x2014; <a href="https://github.com/alitouka" target="_blank">alitouka</a></p>
<p>With adjusting and tweaking the model&#x2019;s parameters epsilon and minPts (in Python: min_samples), we reveal some nice clusters in the feature space.</p>
<p><strong>Following code clusters the 2D feature space.</strong></p>
<pre><code class="lang-python"><span class="hljs-keyword">import</span> pandas <span class="hljs-keyword">as</span> pd
<span class="hljs-keyword">import</span> matplotlib.pyplot <span class="hljs-keyword">as</span> plt
<span class="hljs-keyword">import</span> sys
<span class="hljs-keyword">from</span> numpy <span class="hljs-keyword">import</span> genfromtxt
<span class="hljs-keyword">from</span> sklearn.cluster <span class="hljs-keyword">import</span> DBSCAN

<span class="hljs-comment"># Reading in 2D Feature Space</span>
feature_space = pd.read_csv(<span class="hljs-string">&quot;../datasets/wine-data.csv&quot;</span>, header=<span class="hljs-keyword">None</span>, sep=<span class="hljs-string">&quot;,&quot;</span>)
data = feature_space.iloc[:, <span class="hljs-number">0</span>:<span class="hljs-number">2</span>].values

<span class="hljs-comment"># DBSCAN model with parameters</span>
model = DBSCAN(eps=<span class="hljs-number">0.8</span>, min_samples=<span class="hljs-number">10</span>).fit(data)

<span class="hljs-comment"># PLOTTING</span>
<span class="hljs-comment"># NumPy function to create array from tabular dataset</span>
my_csv = genfromtxt(<span class="hljs-string">&apos;../datasets/wine-data.csv&apos;</span>, delimiter=<span class="hljs-string">&apos;,&apos;</span>)

<span class="hljs-comment"># Slicing array</span>
array_flavanoids = my_csv[:, <span class="hljs-number">0</span>]

<span class="hljs-comment"># Slicing array</span>
array_colorintensity = my_csv[:, <span class="hljs-number">1</span>]

<span class="hljs-comment"># Scatter plot function</span>
colors = model.labels_
plt.scatter(array_flavanoids, array_colorintensity, c=colors, marker=<span class="hljs-string">&apos;o&apos;</span>)
plt.xlabel(<span class="hljs-string">&apos;Concentration of flavanoids&apos;</span>, fontsize=<span class="hljs-number">16</span>)
plt.ylabel(<span class="hljs-string">&apos;Color intensity&apos;</span>, fontsize=<span class="hljs-number">16</span>)
plt.title(<span class="hljs-string">&apos;Concentration of flavanoids vs Color intensity&apos;</span>, fontsize=<span class="hljs-number">20</span>)
plt.show()

sys.exit()
</code></pre>
<h2 id="comparing-the-first-visualization-of-the-feature-space-with-the-cluster-visualization">Comparing the first visualization of the feature space with the cluster visualization</h2>
<p><img src="../.gitbook/assets/dbscan_3.png" alt></p>
<p>Oh yes, and we have finally spotted them!</p>
<h2 id="these-tiny-purple-dots-are-the-outliers-we-were-searching-for">These tiny purple dots are the <strong>outliers</strong> we were searching for!</h2>
<p><img src="../.gitbook/assets/dbscan_4.png" alt></p>
<h2 id="3-&#x2014;-calculating-outliers">#3 &#x2014; Calculating outliers.</h2>
<p>Wow!! Now we know that there <strong>do</strong> exist outliers in the dependency between the <strong>concentration of flavanoids</strong> and the <strong>color intensity</strong> of wine, yaaay (I still don&#x2019;t actually get what flavanoids are, btw). Just one last step&#x2026;</p>
<p><strong>Following code calculates the outliers of the 2D feature space.</strong></p>
<p>This code calculates and finally prints the 11 outliers of the dataset in a separate <a href="https://github.com/JOPloume/outlier-detection-2D-feature-space/blob/master/datasets/dbscan-outliers.csv" target="_blank">CSV-file</a>.</p>
<p>This <strong>step-by-step guide for outlier detection</strong> was created during my thesis project on human-in-the-loop computing, an approach of combining human with machine intelligence. Stay tuned!</p>
<p>[1] Google Cloud, <a href="https://cloud.google.com/ml-engine/docs/ml-solutions-overview" target="_blank">Machine learning workflow</a> (2019)</p>
<p>[2] M. Ester, H.-P. Kriegel, J. Sander and X. Xu, <a href="https://dl-acm-org.proxy.lnu.se/citation.cfm?id=3001507" target="_blank">A density-based algorithm for discovering clusters a density-based algorithm for discovering clusters in large spatial databases with noise</a> (1996), KDD&#x2019;96 Proceedings of the Second International Conference on Knowledge Discovery and Data Mining</p>
<p>[3] <a href="https://towardsdatascience.com/outlier-detection-python-cd22e6a12098" target="_blank">https://towardsdatascience.com/outlier-detection-python-cd22e6a12098</a></p>

                                
                                </section>
                            
                        </div>
                    </div>
                
            </div>

            
                
                <a href="./" class="navigation navigation-prev " aria-label="Previous page: Anomaly Detection">
                    <i class="fa fa-angle-left"></i>
                </a>
                
                
                <a href="autoencoder_anomaly.html" class="navigation navigation-next " aria-label="Next page: Autoencoder">
                    <i class="fa fa-angle-right"></i>
                </a>
                
            
        
    </div>

    <script>
        var gitbook = gitbook || [];
        gitbook.push(function() {
            gitbook.page.hasChanged({"page":{"title":"DBSCAN","level":"1.8.1","depth":2,"next":{"title":"Autoencoder","level":"1.8.2","depth":2,"path":"anomaly-detection/autoencoder_anomaly.md","ref":"anomaly-detection/autoencoder_anomaly.md","articles":[]},"previous":{"title":"Anomaly Detection","level":"1.8","depth":1,"path":"anomaly-detection/README.md","ref":"anomaly-detection/README.md","articles":[{"title":"DBSCAN","level":"1.8.1","depth":2,"path":"anomaly-detection/dbscan.md","ref":"anomaly-detection/dbscan.md","articles":[]},{"title":"Autoencoder","level":"1.8.2","depth":2,"path":"anomaly-detection/autoencoder_anomaly.md","ref":"anomaly-detection/autoencoder_anomaly.md","articles":[]}]},"dir":"ltr"},"config":{"gitbook":"*","theme":"default","variables":{},"plugins":["katex","-search","-lunr","custom-js-css","docsearch","intopic-toc"],"pluginsConfig":{"docsearch":{},"docSearch":{"apiKey":"9b2d0c53eb838616448e652b3caafb42","index":"ztlevi-machine-learning"},"intopic-toc":{"selector":".markdown-section h1, .markdown-section h2, .markdown-section h3","mode":"nested","maxDepth":6,"isCollapsed":true,"isScrollspyActive":true,"visible":true,"label":"Navigation"},"katex":{},"fontsettings":{"theme":"white","family":"sans","size":2},"highlight":{},"custom-js-css":{"css":["css/docsearch.css"]},"sharing":{"facebook":true,"twitter":true,"google":false,"weibo":false,"instapaper":false,"vk":false,"all":["facebook","google","twitter","weibo","instapaper"]},"theme-default":{"styles":{"website":"styles/website.css","pdf":"styles/pdf.css","epub":"styles/epub.css","mobi":"styles/mobi.css","ebook":"styles/ebook.css","print":"styles/print.css"},"showLevel":false}},"structure":{"langs":"LANGS.md","readme":"README.md","glossary":"GLOSSARY.md","summary":"SUMMARY.md"},"pdf":{"pageNumbers":true,"fontSize":12,"fontFamily":"Arial","paperSize":"a4","chapterMark":"pagebreak","pageBreaksBefore":"/","margin":{"right":62,"left":62,"top":56,"bottom":56}},"styles":{"website":"styles/website.css","pdf":"styles/pdf.css","epub":"styles/epub.css","mobi":"styles/mobi.css","ebook":"styles/ebook.css","print":"styles/print.css"}},"file":{"path":"anomaly-detection/dbscan.md","mtime":"2021-06-06T08:01:39.081Z","type":"markdown"},"gitbook":{"version":"3.2.3","time":"2021-06-06T08:02:29.611Z"},"basePath":"..","book":{"language":""}});
        });
    </script>
</div>

        
    <script src="../gitbook/gitbook.js"></script>
    <script src="../gitbook/theme.js"></script>
    
        
        <script src="../gitbook/gitbook-plugin-docsearch/doc-search-lib.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-docsearch/doc-search.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-intopic-toc/anchor.min.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-intopic-toc/gumshoe.polyfills.min.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-intopic-toc/plugin.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-sharing/buttons.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-fontsettings/fontsettings.js"></script>
        
    

    </body>
</html>

